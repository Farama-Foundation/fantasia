<!-- may we pray that we never need this logic -->

{% assign headers = "" | split: "" %}
{% assign links = "" | split: "" %}


{% assign sub_split = include.target_page | split: "##" %}

{% assign lim = sub_split.size | minus: 1 %}

{% for item in sub_split limit:lim offset:1 %}

    {% assign header = item | split: "\n" | first | lstrip | replace: "# ", "" %}
    {% assign link = header | downcase  | replace: " ", "-" %}
    {% assign headers = headers | push: header %}
    {% assign links = links | push: link %}
{% endfor %}

